DROP SCHEMA IF EXISTS SalesManagement;

CREATE SCHEMA SalesManagement;

CREATE TABLE SalesManagement.Sales (
	saleCode   INT(8)      NOT NULL,
	saleName   VARCHAR(20) NOT NULL,
	saleTel    VARCHAR(20) NULL,
	saleAddr   INT(8)      NOT NULL,
	saleLeave  BOOLEAN     NOT NULL DEFAULT true,
	saleId     VARCHAR(20) NOT NULL,
	salesLevel VARCHAR(2)  NOT NULL
);

ALTER TABLE SalesManagement.Sales
	ADD CONSTRAINT PK_Sales
		PRIMARY KEY (
			saleCode
		);

CREATE TABLE SalesManagement.Account (
	accCode  INT(8)      NOT NULL,
	accName  VARCHAR(20) NOT NULL,
	accTel   VARCHAR(20) NULL,
	accAddr  INT(8)      NOT NULL,
	accAdmit BOOLEAN     NOT NULL DEFAULT false,
	accId    VARCHAR(20) NOT NULL,
	accLevel VARCHAR(1)  NULL
);

ALTER TABLE SalesManagement.Account
	ADD CONSTRAINT PK_Account
		PRIMARY KEY (
			accCode
		);

CREATE TABLE SalesManagement.Product (
	pdtCode  INT(4)      NOT NULL,
	pdtClass INT(2)      NOT NULL,
	pdtName  VARCHAR(20) NOT NULL,
	pdtCost  INT(10)     NOT NULL,
	pdtPrice INT(10)     NOT NULL,
	pdtAdmit BOOLEAN     NOT NULL DEFAULT false,
	accCode  INT(8)      NOT NULL
);

ALTER TABLE SalesManagement.Product
	ADD CONSTRAINT PK_Product
		PRIMARY KEY (
			pdtCode
		);

CREATE TABLE SalesManagement.Record (
	recNo       INT(20) NOT NULL,
	pdtCode     INT(4)  NOT NULL,
	saleCode    INT(8)  NOT NULL,
	pdtCost     INT(10) NOT NULL,
	pdtPrice    INT(10) NOT NULL,
	recDate     DATE    NOT NULL,
	recDisprice INT(10) NOT NULL,
	recDisrate  INT(3)  NOT NULL,
	recCount    INT(10) NOT NULL
);

ALTER TABLE SalesManagement.Record
	ADD CONSTRAINT PK_Record
		PRIMARY KEY (
			recNo
		);

CREATE TABLE SalesManagement.User (
	userId     VARCHAR(20) NOT NULL,
	userPw     VARCHAR(20) NOT NULL,
	categoryNo INT(2)      NOT NULL
);

ALTER TABLE SalesManagement.User
	ADD CONSTRAINT PK_User
		PRIMARY KEY (
			userId
		);

CREATE TABLE SalesManagement.AccountLevel (
	accLevel   VARCHAR(1) NOT NULL,
	accDisrate INT(3)     NOT NULL
);

ALTER TABLE SalesManagement.AccountLevel
	ADD CONSTRAINT PK_AccountLevel
		PRIMARY KEY (
			accLevel
		);

CREATE TABLE SalesManagement.bigClass (
	bigClass INT(2)      NOT NULL,
	bigName  VARCHAR(10) NOT NULL
);

ALTER TABLE SalesManagement.bigClass
	ADD CONSTRAINT PK_bigClass
		PRIMARY KEY (
			bigClass
		);

CREATE TABLE SalesManagement.rowClass (
	rowClass INT(2)      NOT NULL,
	rowName  VARCHAR(10) NOT NULL,
	bigClass INT(2)      NOT NULL
);

ALTER TABLE SalesManagement.rowClass
	ADD CONSTRAINT PK_rowClass
		PRIMARY KEY (
			rowClass
		);

CREATE TABLE SalesManagement.maker (
	makerNo   INT(2)      NOT NULL,
	makerName VARCHAR(10) NULL
);

ALTER TABLE SalesManagement.maker
	ADD CONSTRAINT PK_maker
		PRIMARY KEY (
			makerNo
		);

CREATE TABLE SalesManagement.Addr (
	zipCode   CHAR(5)     NULL,
	sido      VARCHAR(20) NULL,
	sigungu   VARCHAR(20) NULL,
	doro      VARCHAR(20) NULL,
	building1 INT(5)      NULL,
	building2 INT(5)      NULL
);

CREATE TABLE SalesManagement.accId (
	accId VARCHAR(10) NOT NULL,
	accPw VARCHAR(16) NOT NULL
);

ALTER TABLE SalesManagement.accId
	ADD CONSTRAINT PK_accId
		PRIMARY KEY (
			accId
		);

CREATE TABLE SalesManagement.saleId (
	saleId    VARCHAR(10) NOT NULL,
	salePw    VARCHAR(16) NOT NULL,
	saleAdmit BOOLEAN     NOT NULL
);

ALTER TABLE SalesManagement.saleId
	ADD CONSTRAINT PK_saleId
		PRIMARY KEY (
			saleId
		);

CREATE TABLE SalesManagement.UserCategory (
	categoryNo   INT(2)      NOT NULL,
	categoryName VARCHAR(20) NOT NULL
);

ALTER TABLE SalesManagement.UserCategory
	ADD CONSTRAINT PK_UserCategory
		PRIMARY KEY (
			categoryNo
		);

CREATE TABLE SalesManagement.SalesLevel (
	salesLevel   VARCHAR(2) NOT NULL,
	salesDisrate INT(3)     NOT NULL
);

ALTER TABLE SalesManagement.SalesLevel
	ADD CONSTRAINT PK_SalesLevel
		PRIMARY KEY (
			salesLevel
		);

CREATE TABLE SalesManagement.UserAddr (
	addrNo    INT(8)      NOT NULL,
	zipCode   CHAR(5)     NULL,
	sido      VARCHAR(20) NULL,
	sigungu   VARCHAR(20) NULL,
	doro      VARCHAR(20) NULL,
	building1 INT(5)      NULL,
	building2 INT(5)      NULL
);

ALTER TABLE SalesManagement.UserAddr
	ADD CONSTRAINT PK_UserAddr
		PRIMARY KEY (
			addrNo
		);

CREATE TABLE SalesManagement.SalesImg (
	saleCode INT(8)   NULL,
	salesImg LONGBLOB NULL
);

CREATE TABLE SalesManagement.ProductImg (
	pdtCode INT(4)   NULL,
	pdtImg  LONGBLOB NULL
);

ALTER TABLE SalesManagement.Sales
	ADD CONSTRAINT FK_User_TO_Sales
		FOREIGN KEY (
			saleId
		)
		REFERENCES SalesManagement.User (
			userId
		);

ALTER TABLE SalesManagement.Sales
	ADD CONSTRAINT FK_SalesLevel_TO_Sales
		FOREIGN KEY (
			salesLevel
		)
		REFERENCES SalesManagement.SalesLevel (
			salesLevel
		);

ALTER TABLE SalesManagement.Sales
	ADD CONSTRAINT FK_UserAddr_TO_Sales
		FOREIGN KEY (
			saleAddr
		)
		REFERENCES SalesManagement.UserAddr (
			addrNo
		);

ALTER TABLE SalesManagement.Account
	ADD CONSTRAINT FK_User_TO_Account
		FOREIGN KEY (
			accId
		)
		REFERENCES SalesManagement.User (
			userId
		);

ALTER TABLE SalesManagement.Account
	ADD CONSTRAINT FK_AccountLevel_TO_Account
		FOREIGN KEY (
			accLevel
		)
		REFERENCES SalesManagement.AccountLevel (
			accLevel
		);

ALTER TABLE SalesManagement.Account
	ADD CONSTRAINT FK_UserAddr_TO_Account
		FOREIGN KEY (
			accAddr
		)
		REFERENCES SalesManagement.UserAddr (
			addrNo
		);

ALTER TABLE SalesManagement.Product
	ADD CONSTRAINT FK_rowClass_TO_Product
		FOREIGN KEY (
			pdtClass
		)
		REFERENCES SalesManagement.rowClass (
			rowClass
		);

ALTER TABLE SalesManagement.Product
	ADD CONSTRAINT FK_Account_TO_Product
		FOREIGN KEY (
			accCode
		)
		REFERENCES SalesManagement.Account (
			accCode
		);

ALTER TABLE SalesManagement.Record
	ADD CONSTRAINT FK_Product_TO_Record
		FOREIGN KEY (
			pdtCode
		)
		REFERENCES SalesManagement.Product (
			pdtCode
		);

ALTER TABLE SalesManagement.Record
	ADD CONSTRAINT FK_Sales_TO_Record
		FOREIGN KEY (
			saleCode
		)
		REFERENCES SalesManagement.Sales (
			saleCode
		);

ALTER TABLE SalesManagement.User
	ADD CONSTRAINT FK_UserCategory_TO_User
		FOREIGN KEY (
			categoryNo
		)
		REFERENCES SalesManagement.UserCategory (
			categoryNo
		);

ALTER TABLE SalesManagement.rowClass
	ADD CONSTRAINT FK_bigClass_TO_rowClass
		FOREIGN KEY (
			bigClass
		)
		REFERENCES SalesManagement.bigClass (
			bigClass
		);

ALTER TABLE SalesManagement.SalesImg
	ADD CONSTRAINT FK_Sales_TO_SalesImg
		FOREIGN KEY (
			saleCode
		)
		REFERENCES SalesManagement.Sales (
			saleCode
		);

ALTER TABLE SalesManagement.ProductImg
	ADD CONSTRAINT FK_Product_TO_ProductImg
		FOREIGN KEY (
			pdtCode
		)
		REFERENCES SalesManagement.Product (
			pdtCode
		);