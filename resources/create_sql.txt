DROP DATABASE IF EXISTS salemanagement;

Create database salemanagement;

CREATE TABLE salemanagement.Sales (
	saleCode  int(4)       NOT NULL,
	saleName  VARCHAR(20)  NOT NULL,
	saleTel   VARCHAR(20)  NULL,
	saleLevel VARCHAR(1)   NULL,
	saleAddr  VARCHAR(120) NULL
);

ALTER TABLE salemanagement.Sales
	ADD CONSTRAINT PK_Sales
		PRIMARY KEY (
			saleCode
		);


CREATE TABLE salemanagement.Account (
	accCode  int(4)       NOT NULL,
	accName  VARCHAR(20)  NOT NULL,
	accTel   VARCHAR(20)  NULL,
	accLevel VARCHAR(1)   NOT NULL,
	accAddr  VARCHAR(120) NULL
);


ALTER TABLE salemanagement.Account
	ADD CONSTRAINT PK_Account
		PRIMARY KEY (
			accCode
		);


CREATE TABLE salemanagement.Product (
	pdtCode  INT(4)      NOT NULL,
	pdtClass INT(2)      NULL,
	pdtName  VARCHAR(20) NOT NULL,
	pdtCost  INT(10)     NOT NULL,
	pdtPrice INT(10)     NOT NULL,
	accCode  int(4)      NULL,
	pdtAdmit BOOLEAN     NOT NULL DEFAULT false
);


ALTER TABLE salemanagement.Product
	ADD CONSTRAINT PK_Product
		PRIMARY KEY (
			pdtCode
		);

CREATE TABLE salemanagement.Record (
	recNo       INT(20) NOT NULL,
	saleCode    int(4)  NOT NULL,
	pdtCode     INT(4)  NOT NULL,
	pdtCost     INT(10) NULL,
	pdtPrice    INT(10) NULL,
	recDate     DATE    NOT NULL,
	recDisprice INT(10) NULL,
	recDisrate  INT(3)  NULL,
	recCount    INT(10) NOT NULL,
	recAdmit    BOOLEAN NOT NULL DEFAULT false
);

ALTER TABLE salemanagement.Record
	ADD CONSTRAINT PK_Record
		PRIMARY KEY (
			recNo
		);

CREATE TABLE salemanagement.SalesLevel (
	saleLevel   VARCHAR(1) NOT NULL,
	saleDisrate INT(3)     NOT NULL
);

ALTER TABLE salemanagement.SalesLevel
	ADD CONSTRAINT PK_SalesLevel
		PRIMARY KEY (
			saleLevel
		);

CREATE TABLE salemanagement.AccountLevel (
	accLevel   VARCHAR(1) NOT NULL,
	accDisrate INT(3)     NOT NULL
);

ALTER TABLE salemanagement.AccountLevel
	ADD CONSTRAINT PK_AccountLevel
		PRIMARY KEY (
			accLevel
		);

CREATE TABLE salemanagement.bigClass (
	bigClass INT(2)      NOT NULL,
	bigName  VARCHAR(10) NULL
);

ALTER TABLE salemanagement.bigClass
	ADD CONSTRAINT PK_bigClass
		PRIMARY KEY (
			bigClass
		);

CREATE TABLE salemanagement.midClass (
	midClass INT(2)      NOT NULL,
	midName  VARCHAR(10) NULL,
	bigClass INT(2)      NULL
);

ALTER TABLE salemanagement.midClass
	ADD CONSTRAINT PK_midClass
		PRIMARY KEY (
			midClass
		);

CREATE TABLE salemanagement.maker (
	makerNo   INT(2)      NOT NULL,
	makerName VARCHAR(10) NULL
);

ALTER TABLE salemanagement.maker
	ADD CONSTRAINT PK_maker
		PRIMARY KEY (
			makerNo
		);

CREATE TABLE salemanagement.Addr (
	zipCode   CHAR(5)     NULL,
	sido      VARCHAR(20) NULL,
	sigungu   VARCHAR(20) NULL,
	doro      VARCHAR(20) NULL,
	building1 INT(5)      NULL,
	building2 INT(5)      NULL
);

CREATE TABLE salemanagement.accId (
	accId    VARCHAR(10) NOT NULL,
	accPw    VARCHAR(16) NOT NULL,
	accAdmit BOOLEAN     NOT NULL,
	accCode  int(4)      NULL
);

ALTER TABLE salemanagement.accId
	ADD CONSTRAINT PK_accId
		PRIMARY KEY (
			accId
		);

CREATE TABLE salemanagement.saleId (
	saleId    VARCHAR(10) NOT NULL,
	salePw    VARCHAR(16) NOT NULL,
	saleCode  int(4)      NOT NULL,
	saleAdmit BOOLEAN     NOT NULL
);

ALTER TABLE salemanagement.saleId
	ADD CONSTRAINT PK_saleId
		PRIMARY KEY (
			saleId
		);

ALTER TABLE salemanagement.Sales
	ADD CONSTRAINT FK_SalesLevel_TO_Sales
		FOREIGN KEY (
			saleLevel
		)
		REFERENCES salemanagement.SalesLevel (
			saleLevel
		);

ALTER TABLE salemanagement.Account
	ADD CONSTRAINT FK_AccountLevel_TO_Account
		FOREIGN KEY (
			accLevel
		)
		REFERENCES salemanagement.AccountLevel (
			accLevel
		);

ALTER TABLE salemanagement.Product
	ADD CONSTRAINT FK_midClass_TO_Product
		FOREIGN KEY (
			pdtClass
		)
		REFERENCES salemanagement.midClass (
			midClass
		);

ALTER TABLE salemanagement.Product
	ADD CONSTRAINT FK_Account_TO_Product
		FOREIGN KEY (
			accCode
		)
		REFERENCES salemanagement.Account (
			accCode
		);

ALTER TABLE salemanagement.Record
	ADD CONSTRAINT FK_Sales_TO_Record
		FOREIGN KEY (
			saleCode
		)
		REFERENCES salemanagement.Sales (
			saleCode
		);

ALTER TABLE salemanagement.Record
	ADD CONSTRAINT FK_Product_TO_Record
		FOREIGN KEY (
			pdtCode
		)
		REFERENCES salemanagement.Product (
			pdtCode
		);

ALTER TABLE salemanagement.midClass
	ADD CONSTRAINT FK_bigClass_TO_midClass
		FOREIGN KEY (
			bigClass 
		)
		REFERENCES salemanagement.bigClass (
			bigClass
		);

ALTER TABLE salemanagement.accId
	ADD CONSTRAINT FK_Account_TO_accId
		FOREIGN KEY (
			accCode
		)
		REFERENCES salemanagement.Account (
			accCode
		);

ALTER TABLE salemanagement.saleId
	ADD CONSTRAINT FK_Sales_TO_saleId
		FOREIGN KEY (
			saleCode
		)
		REFERENCES salemanagement.Sales (
			saleCode
		);

grant select, insert, update, delete on salemanagement.* to 'user_sale_project' identified by 'rootroot';